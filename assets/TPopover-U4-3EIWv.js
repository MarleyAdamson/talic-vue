import{e as q,r as u,c as P,w as K,o as _,x as G,g as w,k as J,z as B,l as E,s as O,B as R,I as Q,C as X,p as k,j as S,n as A}from"./vue.esm-bundler-CJdtXRgK.js";import{_ as Y}from"./TCard-iiimh3rz.js";const Z=["id"],I=q({__name:"TPopover",props:{modelValue:{type:Boolean,default:!1},placement:{type:String,default:"bottom",validator:a=>["top","right","bottom","left","auto"].includes(a)},offset:{type:Number,default:8},showArrow:{type:Boolean,default:!1},closeOnClickOutside:{type:Boolean,default:!0},animated:{type:Boolean,default:!0},class:{type:String,default:""},elevation:{type:String,default:"lg"},id:{type:String,default:()=>`popover-${Math.random().toString(36).substring(2,9)}`},ariaLabel:{type:String,default:""},ariaLabelledby:{type:String,default:""},ariaDescribedby:{type:String,default:""},autoFocus:{type:Boolean,default:!0}},emits:["update:modelValue","show","hide"],setup(a,{emit:v}){const t=a,c=v,m=u(null),d=u(null),o=u(null),r=u(t.modelValue),V=u({}),f=u(null),i=u(null),D=P(()=>({"aria-haspopup":"dialog","aria-expanded":r.value,"aria-controls":t.id})),T=P(()=>{const e={role:"dialog",tabindex:"-1"};return t.ariaLabel&&(e["aria-label"]=t.ariaLabel),t.ariaLabelledby&&(e["aria-labelledby"]=t.ariaLabelledby),t.ariaDescribedby&&(e["aria-describedby"]=t.ariaDescribedby),e}),h=()=>{if(!r.value||!d.value||!o.value)return;const e=d.value.getBoundingClientRect(),l=o.value.getBoundingClientRect(),b=window.innerWidth,g=window.innerHeight;let y=t.placement;if(y==="auto"){const W=g-e.bottom,F=e.top,M=b-e.right,H=e.left;y=[{placement:"bottom",space:W},{placement:"top",space:F},{placement:"right",space:M},{placement:"left",space:H}].sort((U,j)=>j.space-U.space)[0].placement}let n=0,s=0;switch(y){case"top":n=e.top-l.height-t.offset,s=e.left+e.width/2-l.width/2;break;case"right":n=e.top+e.height/2-l.height/2,s=e.right+t.offset;break;case"bottom":n=e.bottom+t.offset,s=e.left+e.width/2-l.width/2;break;case"left":n=e.top+e.height/2-l.height/2,s=e.left-l.width-t.offset;break}s<10&&(s=10),s+l.width>b-10&&(s=b-l.width-10),n<10&&(n=10),n+l.height>g-10&&(n=g-l.height-10),V.value={position:"fixed",top:`${n}px`,left:`${s}px`,zIndex:"9999"},o.value&&(o.value.style.position="fixed",o.value.style.top=`${n}px`,o.value.style.left=`${s}px`,o.value.style.zIndex="9999")},p=()=>{h()};K(()=>t.modelValue,e=>{e?x():$()});const x=async()=>{r.value=!0,await X(),h(),typeof IntersectionObserver<"u"&&!i.value&&o.value&&(i.value=new IntersectionObserver(e=>{e[0].isIntersecting||h()},{threshold:.5}),i.value.observe(o.value)),t.autoFocus&&o.value&&(f.value=document.activeElement,o.value.focus()),c("show")},$=()=>{r.value=!1,i.value&&(i.value.disconnect(),i.value=null),f.value&&(f.value.focus(),f.value=null),c("hide")},z=()=>{c("update:modelValue",!r.value)},L=e=>{r.value&&e.key==="Escape"&&(c("update:modelValue",!1),e.preventDefault())},C=e=>{if(!t.closeOnClickOutside||!r.value)return;const l=e.target;d.value&&(d.value===l||d.value.contains(l))||o.value&&(o.value===l||o.value.contains(l))||c("update:modelValue",!1)},N=e=>{e.preventDefault(),e.stopPropagation(),z()};return _(()=>{document.addEventListener("click",C),document.addEventListener("keydown",L),window.addEventListener("resize",p),window.addEventListener("scroll",p,!0),t.modelValue&&x()}),G(()=>{document.removeEventListener("click",C),document.removeEventListener("keydown",L),window.removeEventListener("resize",p),window.removeEventListener("scroll",p,!0),i.value&&(i.value.disconnect(),i.value=null)}),(e,l)=>(k(),w("div",{ref_key:"containerRef",ref:m,class:"relative inline-block"},[J("div",O({ref_key:"triggerRef",ref:d,onClick:N,class:"inline-block cursor-pointer"},D.value),[E(e.$slots,"trigger",{},void 0,!0)],16),B(Q,{"enter-active-class":t.animated?"transition-all duration-200 ease-out":"","enter-from-class":t.animated?"opacity-0 scale-95":"","enter-to-class":t.animated?"opacity-100 scale-100":"","leave-active-class":t.animated?"transition-all duration-150 ease-in":"","leave-from-class":t.animated?"opacity-100 scale-100":"","leave-to-class":t.animated?"opacity-0 scale-95":""},{default:R(()=>[r.value?(k(),w("div",O({key:0,ref_key:"popoverRef",ref:o,id:a.id},T.value,{class:["fixed z-50 w-max"],style:V.value}),[a.showArrow?(k(),w("div",{key:0,class:A(["absolute h-3 w-3 rotate-45 border bg-white",a.placement==="top"?"bottom-0 translate-y-1/2 border-r border-b":"",a.placement==="right"?"left-0 -translate-x-1/2 border-t border-l":"",a.placement==="bottom"?"top-0 -translate-y-1/2 border-t border-l":"",a.placement==="left"?"right-0 translate-x-1/2 border-r border-b":"",a.placement==="top"||a.placement==="bottom"?"left-1/2 -translate-x-1/2":"",a.placement==="left"||a.placement==="right"?"top-1/2 -translate-y-1/2":""]),"aria-hidden":"true"},null,2)):S("",!0),B(Y,{elevation:a.elevation,class:A(["overflow-hidden",["relative",t.class]])},{default:R(()=>[E(e.$slots,"default",{},void 0,!0)]),_:3},8,["elevation","class"])],16,Z)):S("",!0)]),_:3},8,["enter-active-class","enter-from-class","enter-to-class","leave-active-class","leave-from-class","leave-to-class"])],512))}}),ee=(a,v)=>{const t=a.__vccOpts||a;for(const[c,m]of v)t[c]=m;return t},ne=ee(I,[["__scopeId","data-v-1311e7a3"]]);I.__docgenInfo={exportName:"default",displayName:"TPopover",description:"",tags:{},props:[{name:"modelValue",description:"Controls whether the popover is visible",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"placement",description:"Preferred placement of the popover (will be overridden if needed to fit viewport)",type:{name:"PopoverPlacement"},defaultValue:{func:!1,value:"'bottom'"},values:["top","right","bottom","left","auto"]},{name:"offset",description:"Offset (in pixels) from the trigger element",type:{name:"number"},defaultValue:{func:!1,value:"8"}},{name:"showArrow",description:"Whether to show an arrow pointing to the trigger",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"closeOnClickOutside",description:"Whether clicking outside the popover should close it",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"animated",description:"Whether to animate the popover entrance/exit",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"class",description:"Additional classes to apply to the popover card",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"elevation",description:"Card elevation to use (passed to TCard)",type:{name:"string"},defaultValue:{func:!1,value:"'lg'"}},{name:"id",description:"ID for the popover element (required for accessibility)",type:{name:"string"},defaultValue:{func:!0,value:"() => `popover-${Math.random().toString(36).substring(2, 9)}`"}},{name:"ariaLabel",description:"Accessible label for the popover (used when no visible label is present)",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"ariaLabelledby",description:"ID of an element that labels the popover (used instead of ariaLabel)",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"ariaDescribedby",description:"ID of an element that describes the popover",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"autoFocus",description:"Whether to focus the first focusable element in the popover when opened",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}}],events:[{name:"update:modelValue",type:{names:["boolean"]}},{name:"show"},{name:"hide"}],slots:[{name:"trigger"},{name:"default"}],sourceFiles:["/Users/marley/Dev/talic-vue/src/components/TPopover.vue"]};export{ne as T,ee as _};
