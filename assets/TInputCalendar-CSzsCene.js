import{e as de,r as C,w as q,c as y,o as ce,g as h,z as M,B as V,n as B,p as v,k as m,j as fe,t as D,F as T,E as A,m as me,v as pe,G as P,H as K,h as U}from"./vue.esm-bundler-CJdtXRgK.js";import{_ as ye}from"./TInput-D4F_TQjo.js";import{T as he,_ as ve}from"./TPopover-U4-3EIWv.js";import{_ as N}from"./TButton-DKkzQOAf.js";const ge={class:"w-72 p-2 select-none"},be={class:"mb-2 flex items-center justify-between"},De={class:"flex items-center space-x-1 font-medium"},we={id:"calendar-month-label",class:"sr-only"},Me=["id","value"],Ve=["value"],Se=["id","value"],ke=["value"],xe={class:"mb-1 grid grid-cols-7 text-center text-xs font-semibold text-gray-700"},Ie=["aria-label"],Ce={class:"hidden sm:inline"},Te={class:"sm:hidden"},Ae={class:"grid grid-cols-7 gap-1",role:"grid","aria-labelledby":"calendar-month-label"},Fe=["id","aria-label","aria-disabled","aria-selected","aria-current","tabindex","onClick","onKeydown","disabled"],_e={key:0,class:"mt-2 flex justify-center"},j=de({__name:"TInputCalendar",props:{modelValue:{type:Date,default:null},variant:{type:String,default:"primary"},size:{type:String,default:"md"},placeholder:{type:String,default:"Select date..."},label:{type:String,default:"Date"},disabled:{type:Boolean,default:!1},helpText:{type:String,default:""},errorMessage:{type:String,default:""},required:{type:Boolean,default:!1},weekdayStart:{type:String,default:"monday",validator:d=>["monday","sunday","saturday"].includes(d)},displayFormat:{type:String,default:"yyyy-MM-dd"},minDate:{type:Date,default:void 0},maxDate:{type:Date,default:void 0},disabledDates:{type:Array,default:()=>[]},disableBefore:{type:Date,default:void 0},disableAfter:{type:Date,default:void 0},id:{type:String,default:""},fullWidth:{type:Boolean,default:!0},calendarAriaLabel:{type:String,default:"Date picker calendar"},classes:{type:String,default:""}},emits:["update:modelValue","change"],setup(d,{emit:O}){const n=d,w=O,b=C(!1),c=C(new Date),f=C(new Date().getFullYear()),S=new Date;S.setHours(0,0,0,0),q(()=>n.modelValue,e=>{e&&(c.value=new Date(e),f.value=e.getFullYear())},{immediate:!0}),q(()=>b.value,e=>{e&&n.modelValue&&(c.value=new Date(n.modelValue),f.value=n.modelValue.getFullYear())});const R=C(`calendar-${Math.random().toString(36).substring(2,11)}`),I=y(()=>n.id||R.value),z=y(()=>`${I.value}-calendar`),G=y(()=>`${I.value}-month-select`),Z=y(()=>`${I.value}-year-select`),J=e=>{if(!e)return"";switch(n.displayFormat){case"MM/dd/yyyy":return`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()}`;case"dd/MM/yyyy":return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`;case"MMM dd, yyyy":return`${e.toLocaleString("default",{month:"short"})} ${e.getDate()}, ${e.getFullYear()}`;case"yyyy-MM-dd":default:return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}},Q=e=>{if(!e)return null;try{let a=null;switch(n.displayFormat){case"MM/dd/yyyy":{const[l,t,s]=e.split("/").map(Number);a=new Date(s,l-1,t);break}case"dd/MM/yyyy":{const[l,t,s]=e.split("/").map(Number);a=new Date(s,t-1,l);break}case"MMM dd, yyyy":{a=new Date(e);break}case"yyyy-MM-dd":default:{const[l,t,s]=e.split("-").map(Number);a=new Date(l,t-1,s);break}}return isNaN(a.getTime())?null:a}catch{return null}},X=y(()=>{const e=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return n.weekdayStart==="sunday"?e.unshift(e.pop()):n.weekdayStart==="saturday"&&(e.unshift(e.pop()),e.unshift(e.pop())),e.map(a=>({full:a,short:a.substring(0,3),narrow:a.substring(0,1)}))}),ee=y(()=>n.weekdayStart==="sunday"?0:n.weekdayStart==="saturday"?6:1),k=y(()=>{const e=f.value,a=c.value.getMonth(),l=new Date(e,a+1,0).getDate();let s=new Date(e,a,1).getDay();s=(s-ee.value+7)%7;const u=[],o=new Date(e,a,0).getDate();for(let i=s-1;i>=0;i--){const r=new Date(e,a-1,o-i);u.push({date:r,isCurrentMonth:!1,isToday:g(r,S),isSelected:n.modelValue?g(r,n.modelValue):!1,isDisabled:F(r)})}for(let i=1;i<=l;i++){const r=new Date(e,a,i);u.push({date:r,isCurrentMonth:!0,isToday:g(r,S),isSelected:n.modelValue?g(r,n.modelValue):!1,isDisabled:F(r)})}const Y=Math.ceil(u.length/7)*7-u.length;for(let i=1;i<=Y;i++){const r=new Date(e,a+1,i);u.push({date:r,isCurrentMonth:!1,isToday:g(r,S),isSelected:n.modelValue?g(r,n.modelValue):!1,isDisabled:F(r)})}return u}),g=(e,a)=>e.getFullYear()===a.getFullYear()&&e.getMonth()===a.getMonth()&&e.getDate()===a.getDate(),F=e=>{const a=new Date(e);if(a.setHours(0,0,0,0),n.minDate){const l=new Date(n.minDate);if(l.setHours(0,0,0,0),a<l)return!0}if(n.maxDate){const l=new Date(n.maxDate);if(l.setHours(0,0,0,0),a>l)return!0}if(n.disableBefore){const l=new Date(n.disableBefore);if(l.setHours(0,0,0,0),a<l)return!0}if(n.disableAfter){const l=new Date(n.disableAfter);if(l.setHours(0,0,0,0),a>l)return!0}return n.disabledDates.some(l=>l?g(a,l):!1)},ae=y(()=>{const e=new Date().getFullYear();return Array.from({length:21},(a,l)=>e-10+l)}),H=y(()=>Array.from({length:12},(e,a)=>({value:a,name:new Date(f.value,a).toLocaleString("default",{month:"long"})}))),E=()=>{c.value=new Date(f.value,c.value.getMonth()-1),f.value=c.value.getFullYear()},L=()=>{c.value=new Date(f.value,c.value.getMonth()+1),f.value=c.value.getFullYear()},te=()=>{const e=new Date;e.setHours(0,0,0,0),c.value=new Date(e.getFullYear(),e.getMonth()),f.value=e.getFullYear(),w("update:modelValue",e),w("change",e)},le=e=>{const a=e.target;c.value=new Date(f.value,parseInt(a.value))},ne=e=>{const a=e.target;f.value=parseInt(a.value),c.value=new Date(f.value,c.value.getMonth())},W=e=>{if(e.isDisabled)return;const a=new Date(e.date);w("update:modelValue",a),w("change",a),b.value=!1},se=(e,a,l)=>{var $;const t=k.value,s=Math.ceil(t.length/7),u=Math.floor(l/7),p=l%7;let o=-1;switch(e.key){case"ArrowLeft":o=l-1,p===0&&(o=l+6);break;case"ArrowRight":o=l+1,p===6&&(o=l-6);break;case"ArrowUp":o=l-7,u===0&&(o=l+7*(s-1));break;case"ArrowDown":o=l+7,u===s-1&&(o=l-7*(s-1));break;case"Home":o=u*7;break;case"End":o=u*7+6;break;case"PageUp":E(),o=7+p,e.preventDefault();break;case"PageDown":L(),o=7+p,e.preventDefault();break;case"Enter":case" ":W(a),e.preventDefault();return;default:return}if(o>=0&&o<t.length){if(e.preventDefault(),t[o].isDisabled){let i=0;(e.key==="ArrowLeft"||e.key==="Home")&&(i=-1),(e.key==="ArrowRight"||e.key==="End")&&(i=1),e.key==="ArrowUp"&&(i=-7),e.key==="ArrowDown"&&(i=7);let r=o;for(let x=0;x<7;x++)if(r+=i,r>=0&&r<t.length&&!t[r].isDisabled){o=r;break}if(t[o].isDisabled)return}t.forEach((i,r)=>{const x=document.getElementById(`day-${r}`);x&&x.setAttribute("tabindex",r===o?"0":"-1")});const Y=`day-${o}`;($=document.getElementById(Y))==null||$.focus()}},re=e=>{const a=e.target,l=Q(a.value);l&&(w("update:modelValue",l),w("change",l),c.value=new Date(l.getFullYear(),l.getMonth()),f.value=l.getFullYear())},oe=y(()=>J(n.modelValue)),ue=()=>U("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-5 w-5"},[U("path",{d:"M6.75 2.25A.75.75 0 0 1 7.5 3v1.5h9V3A.75.75 0 0 1 18 3v1.5h.75a3 3 0 0 1 3 3v11.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V7.5a3 3 0 0 1 3-3H6V3a.75.75 0 0 1 .75-.75Zm13.5 9a1.5 1.5 0 0 0-1.5-1.5H5.25a1.5 1.5 0 0 0-1.5 1.5v7.5a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5v-7.5Z"})]),_=e=>{e.preventDefault(),e.stopPropagation(),b.value=!0,setTimeout(()=>{var l;let a=-1;if(n.modelValue&&(a=k.value.findIndex(t=>t.isSelected&&g(t.date,n.modelValue))),a===-1&&(a=k.value.findIndex(t=>t.isCurrentMonth&&!t.isDisabled)),a!==-1){const t=`day-${a}`;(l=document.getElementById(t))==null||l.focus(),k.value.forEach((s,u)=>{const p=document.getElementById(`day-${u}`);p&&p.setAttribute("tabindex",u===a?"0":"-1")})}},100)},ie=y(()=>{var e,a,l,t,s,u,p;return typeof window>"u"?!1:((a=(e=window==null?void 0:window.location)==null?void 0:e.href)==null?void 0:a.includes("viewMode=story"))||((t=(l=window==null?void 0:window.location)==null?void 0:l.href)==null?void 0:t.includes("story-"))||((p=(u=(s=window==null?void 0:window.parent)==null?void 0:s.location)==null?void 0:u.href)==null?void 0:p.includes("storybook"))});return ce(()=>{ie.value&&n.modelValue&&setTimeout(()=>{b.value=!0,setTimeout(()=>{b.value=!1},100)},100)}),(e,a)=>(v(),h("div",{class:B(["relative",{"w-full":d.fullWidth},d.classes])},[M(he,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=l=>b.value=l),placement:"bottom",offset:4,"close-on-click-outside":!0,id:z.value,"aria-label":d.calendarAriaLabel,class:B("calendar-popover")},{trigger:V(()=>[m("div",{onClick:_,class:"w-full cursor-pointer"},[M(ye,{id:I.value,type:"text",variant:d.variant,size:d.size,"model-value":oe.value,placeholder:d.placeholder,label:d.label,disabled:d.disabled,"help-text":d.helpText,"error-message":d.errorMessage,required:d.required,"full-width":d.fullWidth,classes:d.classes,readonly:"",tabindex:"0","aria-haspopup":"dialog","aria-controls":z.value,"aria-expanded":b.value,onChange:re,onKeydown:[P(K(_,["prevent"]),["enter"]),P(K(_,["prevent"]),["space"])]},{suffix:V(()=>[M(ue)]),_:1},8,["id","variant","size","model-value","placeholder","label","disabled","help-text","error-message","required","full-width","classes","aria-controls","aria-expanded","onKeydown"])])]),default:V(()=>{var l;return[m("div",ge,[m("div",be,[M(N,{size:"sm",variant:"ghost","aria-label":"Previous month",onClick:E},{default:V(()=>a[1]||(a[1]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-5 w-5"},[m("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])),_:1}),m("div",De,[m("span",we,D((l=H.value.find(t=>t.value===c.value.getMonth()))==null?void 0:l.name)+" "+D(f.value),1),m("select",{id:G.value,class:"cursor-pointer rounded border border-gray-300 bg-white px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none",value:c.value.getMonth(),onChange:le,"aria-label":"Select month"},[(v(!0),h(T,null,A(H.value,t=>(v(),h("option",{key:t.value,value:t.value},D(t.name),9,Ve))),128))],40,Me),m("select",{id:Z.value,class:"cursor-pointer rounded border border-gray-300 bg-white px-2 py-1 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none",value:f.value,onChange:ne,"aria-label":"Select year"},[(v(!0),h(T,null,A(ae.value,t=>(v(),h("option",{key:t,value:t},D(t),9,ke))),128))],40,Se)]),M(N,{size:"sm",variant:"ghost","aria-label":"Next month",onClick:L},{default:V(()=>a[2]||(a[2]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-5 w-5"},[m("path",{"fill-rule":"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z","clip-rule":"evenodd"})],-1)])),_:1})]),m("div",xe,[(v(!0),h(T,null,A(X.value,(t,s)=>(v(),h("div",{key:s,class:"p-1","aria-label":t.full},[m("span",Ce,D(t.short),1),m("span",Te,D(t.narrow),1)],8,Ie))),128))]),m("div",Ae,[(v(!0),h(T,null,A(k.value,(t,s)=>(v(),h("button",{id:`day-${s}`,key:s,class:B(["flex h-8 w-full items-center justify-center rounded text-sm transition focus:ring-2 focus:ring-blue-400 focus:outline-none",t.isDisabled?"cursor-not-allowed opacity-40":"cursor-pointer",t.isCurrentMonth?"font-medium":"text-gray-400",t.isToday&&!t.isSelected?"border border-blue-500":"",t.isSelected&&!t.isDisabled?"bg-blue-500 text-white":"",!t.isSelected&&!t.isDisabled&&!t.isToday?"hover:bg-gray-100":""]),"aria-label":t.date.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),"aria-disabled":t.isDisabled,"aria-selected":t.isSelected,"aria-current":t.isToday?"date":void 0,tabindex:t.isSelected?0:-1,role:"gridcell",onClick:u=>W(t),onKeydown:u=>se(u,t,s),disabled:t.isDisabled},D(t.date.getDate()),43,Fe))),128))]),!n.modelValue||!g(n.modelValue,me(S))?(v(),h("div",_e,[M(N,{size:"sm",variant:"secondary",onClick:te,"aria-label":"Go to today"},{default:V(()=>a[3]||(a[3]=[pe(" Today ")])),_:1})])):fe("",!0)])]}),_:1},8,["modelValue","id","aria-label"])],2))}}),ze=ve(j,[["__scopeId","data-v-c63b6a38"]]);j.__docgenInfo={exportName:"default",displayName:"TInputCalendar",description:"",tags:{},props:[{name:"modelValue",description:"The date value / v-model",type:{name:"date"},defaultValue:{func:!1,value:"null"}},{name:"variant",description:"Input variant, passed to TInput",type:{name:"InputVariant"},defaultValue:{func:!1,value:"'primary'"}},{name:"size",description:"Input size, passed to TInput",type:{name:"InputSize"},defaultValue:{func:!1,value:"'md'"}},{name:"placeholder",description:"Placeholder text for the input",type:{name:"string"},defaultValue:{func:!1,value:"'Select date...'"}},{name:"label",description:"Label for the input",type:{name:"string"},defaultValue:{func:!1,value:"'Date'"}},{name:"disabled",description:"Whether the input is disabled",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"helpText",description:"Help text to display below the input",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"errorMessage",description:"Error message to display below the input",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"required",description:"Whether the input is required",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"weekdayStart",description:"Day of the week to start the calendar on",type:{name:"WeekdayStart"},defaultValue:{func:!1,value:"'monday'"},values:["monday","sunday","saturday"]},{name:"displayFormat",description:"Display format for the date in the input",type:{name:"DateDisplayFormat"},defaultValue:{func:!1,value:"'yyyy-MM-dd'"}},{name:"minDate",description:"Minimum selectable date",type:{name:"date"},defaultValue:{func:!1,value:"undefined"}},{name:"maxDate",description:"Maximum selectable date",type:{name:"date"},defaultValue:{func:!1,value:"undefined"}},{name:"disabledDates",description:"Array of dates to disable",type:{name:"Date[]"},defaultValue:{func:!0,value:"() => []"}},{name:"disableBefore",description:"Disable all dates before this date",type:{name:"date"},defaultValue:{func:!1,value:"undefined"}},{name:"disableAfter",description:"Disable all dates after this date",type:{name:"date"},defaultValue:{func:!1,value:"undefined"}},{name:"id",description:"ID to use for the input element",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"fullWidth",description:"Whether the input should be full width",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"calendarAriaLabel",description:"Accessible label for the calendar",type:{name:"string"},defaultValue:{func:!1,value:"'Date picker calendar'"}},{name:"classes",description:"Additional classes to apply to the input",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"update:modelValue",type:{names:["Date"]}},{name:"change",type:{names:["Date"]}}],sourceFiles:["/Users/marley/Dev/talic-vue/src/components/TInputCalendar.vue"]};export{ze as T};
